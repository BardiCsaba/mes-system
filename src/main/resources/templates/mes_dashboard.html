<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MES Dashboard</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .status-received { color: gray; }
        .status-scheduled { color: orange; }
        .status-in_progress { color: blue; font-weight: bold; }
        .status-completed { color: green; }
        .status-failed { color: red; font-weight: bold; }
        .no-orders { color: gray; font-style: italic; }
        .refresh-link { margin-bottom: 15px; display: block; }
    </style>
</head>
<body>

<h1>MES Production Order Steps</h1>

<a href="/ui/dashboard" class="refresh-link">Refresh List</a>

<div th:if="${orderSteps == null || orderSteps.isEmpty()}">
    <p class="no-orders">No order steps found in the MES system.</p>
</div>

<div th:if="${orderSteps != null && !orderSteps.isEmpty()}">
    <table>
        <thead>
        <tr>
            <th>MES ID</th>
            <th>ERP Item ID</th>
            <th>Product Type</th>
            <th>Quantity</th>
            <th>Due Date</th>
            <th>Status</th>
            <th>Assigned Machine</th>
            <th>Received</th>
            <th>Completed</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="step : ${orderSteps}">
            <td th:text="${step.id}">1</td>
            <td th:text="${step.erpOrderItemId}">101</td>
            <td th:text="'P' + ${step.productType}">P5</td>
            <td th:text="${step.requiredQuantity}">10</td>
            <td th:text="${step.dueDate}">2025-04-25</td>
            <td>
                <span th:text="${step.status}"
                      th:classappend="'status-' + ${#strings.toLowerCase(step.status.name())}">RECEIVED</span>
            </td>
            <td th:text="${step.assignedMachine?.machineName}">-</td>
            <td th:text="${#temporals.format(step.receivedTimestamp, 'yyyy-MM-dd HH:mm:ss')}">-</td>
            <td th:text="${step.completionTimestamp != null ? #temporals.format(step.completionTimestamp, 'yyyy-MM-dd HH:mm:ss') : '-'}">-</td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>